{% load static %}
<!DOCTYPE html>
<html>
<head>
    {% block title %}
        <title>Customer Relationship Management</title>
    {% endblock %}
    {% block stylesheets %}
        <link rel="stylesheet" type="text/css" href="{% static 'crm/styles.css' %}">
    {% endblock %}
    {% comment %} <script>
        document.addEventListener("DOMContentLoaded", function() {
            const sessionTimeout = 60; // Session timeout in seconds (1 minute)
            const warningTime = 30; // Time before session expiry to show warning (in seconds)

            let timeToWarning = sessionTimeout - warningTime;

            

            // Set timeout to show warning before session expires

            // Check session status periodically
            setInterval(checkSession, 10000); // Check every 10 seconds

            function checkSession() {
                fetch("{% url 'check_session' %}")
                    .then(response => response.json())
                    .then(data => {
                        if (!data.active) {
                            console.log('Session expired. Redirecting to login.'); // Debugging log
                            alert("Your session has expired. You will be redirected to the login page.");
                            window.location.reload();
                        }
                    })
                    .catch(error => console.error('Error checking session:', error));
            }
        });
    </script> {% endcomment %}
</head>
<body>  
  
<header id="home">
    <div class="navbar" id="navbar">
        <div class="navbar-tabs" id="navbar-tabs">
            <ul class="navbar-tabs-ul">
                <li>{{ user.username }}</li>
                {% if is_staff %}
                    <li><a href="{% url 'dashboard' %}">Dashboard</a></li>   
                    <li><a href="{% url 'task_list' %}">Task & Diary Management</a></li>
                    <li><a href="{% url 'appointment_list' %}">Appointment Management</a></li> 
                    <li><a href="{% url 'lead-view' %}">Lead </a></li> 
                    <li><a href="{% url 'customer-view' %}">Customer Records</a></li>
                    <li><a href="{% url 'profile_page' %}">My Profile</a></li> 
                {% elif is_accMngr %}
                    <li><a href="{% url 'dashboard' %}">Dashboard</a></li>   
                    <li><a href="{% url 'task_list' %}">Task & Diary Management</a></li>
                    <li><a href="{% url 'appointment_list' %}">Appointment Management</a></li> 
                    <li><a href="{% url 'lead-view' %}">Lead </a></li> 
                    <li><a href="{% url 'customer-view' %}">Customer Records</a></li> 
                    <li><a href="{% url 'profile_page' %}">My Profile</a></li> 
                    <li><a href="{% url 'mngr_dashboard' %}">Manager Panel</a></li>
                {% elif is_admin %}
                    <li><a href="{% url 'dashboard' %}">Dashboard</a></li>   
                    <li><a href="{% url 'task_list' %}">Task & Diary Management</a></li>
                    <li><a href="{% url 'appointment_list' %}">Appointment Management</a></li> 
                    <li><a href="{% url 'lead-view' %}">Lead </a></li> 
                    <li><a href="{% url 'customer-view' %}">Customer Records</a></li> 
                    {% comment %} <li><a href="{% url '' %}">Admin Panel</a></li> {% endcomment %}
                {% endif %}
                <li><a href="{% url 'logout' %}">Logout</a></li>
            </ul>
        </div>
    </div>
</header>
    <h1>Customer Relationship Management</h1>
    <main>
        {% block content %}
        {% endblock %}
    </main>
</body>

</html>
